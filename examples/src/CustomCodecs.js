// Generated by ReScript, PLEASE EDIT WITH CARE
'use strict';

var Spice = require("@greenlabs/ppx-spice/src/rescript/Spice.js");
var Js_dict = require("rescript/lib/js/js_dict.js");
var Js_json = require("rescript/lib/js/js_json.js");
var Js_array = require("rescript/lib/js/js_array.js");
var Belt_Array = require("rescript/lib/js/belt_Array.js");
var Belt_Option = require("rescript/lib/js/belt_Option.js");
var Belt_Result = require("rescript/lib/js/belt_Result.js");

function status_encode(v) {
  switch (v) {
    case /* WAITING */0 :
        return ["WAITING"];
    case /* PROCESSING */1 :
        return ["PROCESSING"];
    case /* SUCCESS */2 :
        return ["SUCCESS"];
    case /* FAIL */3 :
        return ["FAIL"];
    
  }
}

function status_decode(v) {
  var json_arr = Js_json.classify(v);
  if (typeof json_arr === "number") {
    return Spice.error(undefined, "Not a variant", v);
  }
  if (json_arr.TAG !== /* JSONArray */3) {
    return Spice.error(undefined, "Not a variant", v);
  }
  var json_arr$1 = json_arr._0;
  if (json_arr$1.length === 0) {
    return Spice.error(undefined, "Expected variant, found empty array", v);
  }
  var tagged = Js_array.map(Js_json.classify, json_arr$1);
  var match = Belt_Array.getExn(tagged, 0);
  if (typeof match !== "number" && match.TAG === /* JSONString */0) {
    switch (match._0) {
      case "FAIL" :
          if (tagged.length !== 1) {
            return Spice.error(undefined, "Invalid number of arguments to variant constructor", v);
          } else {
            return {
                    TAG: /* Ok */0,
                    _0: /* FAIL */3
                  };
          }
      case "PROCESSING" :
          if (tagged.length !== 1) {
            return Spice.error(undefined, "Invalid number of arguments to variant constructor", v);
          } else {
            return {
                    TAG: /* Ok */0,
                    _0: /* PROCESSING */1
                  };
          }
      case "SUCCESS" :
          if (tagged.length !== 1) {
            return Spice.error(undefined, "Invalid number of arguments to variant constructor", v);
          } else {
            return {
                    TAG: /* Ok */0,
                    _0: /* SUCCESS */2
                  };
          }
      case "WAITING" :
          if (tagged.length !== 1) {
            return Spice.error(undefined, "Invalid number of arguments to variant constructor", v);
          } else {
            return {
                    TAG: /* Ok */0,
                    _0: /* WAITING */0
                  };
          }
      default:
        
    }
  }
  return Spice.error(undefined, "Invalid variant constructor", Belt_Array.getExn(json_arr$1, 0));
}

function encoderStatus(v) {
  switch (v) {
    case /* WAITING */0 :
        return "waiting";
    case /* PROCESSING */1 :
        return "processing";
    case /* SUCCESS */2 :
        return "success";
    case /* FAIL */3 :
        return "fail";
    
  }
}

function decoderStatus(json) {
  var str = Js_json.classify(json);
  if (typeof str === "number") {
    return {
            TAG: /* Error */1,
            _0: {
              path: "",
              message: "Expected JSONString",
              value: json
            }
          };
  }
  if (str.TAG !== /* JSONString */0) {
    return {
            TAG: /* Error */1,
            _0: {
              path: "",
              message: "Expected JSONString",
              value: json
            }
          };
  }
  switch (str._0) {
    case "fail" :
        return {
                TAG: /* Ok */0,
                _0: /* FAIL */3
              };
    case "processing" :
        return {
                TAG: /* Ok */0,
                _0: /* PROCESSING */1
              };
    case "success" :
        return {
                TAG: /* Ok */0,
                _0: /* SUCCESS */2
              };
    case "waiting" :
        return {
                TAG: /* Ok */0,
                _0: /* WAITING */0
              };
    default:
      return {
              TAG: /* Error */1,
              _0: {
                path: "",
                message: "Expected JSONString",
                value: json
              }
            };
  }
}

var codecStatus = [
  encoderStatus,
  decoderStatus
];

function data_encode(v) {
  return Js_dict.fromArray(Spice.filterOptional([[
                    "status",
                    false,
                    encoderStatus(v.status)
                  ]]));
}

function data_decode(v) {
  var dict = Js_json.classify(v);
  if (typeof dict === "number") {
    return Spice.error(undefined, "Not an object", v);
  }
  if (dict.TAG !== /* JSONObject */2) {
    return Spice.error(undefined, "Not an object", v);
  }
  var status = decoderStatus(Belt_Option.getWithDefault(Js_dict.get(dict._0, "status"), null));
  if (status.TAG === /* Ok */0) {
    return {
            TAG: /* Ok */0,
            _0: {
              status: status._0
            }
          };
  }
  var e = status._0;
  return {
          TAG: /* Error */1,
          _0: {
            path: ".status" + e.path,
            message: e.message,
            value: e.value
          }
        };
}

var data = {
    "status": "success"
  };

var data$1 = data_decode(data);

var json = data_encode(Belt_Result.getExn(data$1));

exports.status_encode = status_encode;
exports.status_decode = status_decode;
exports.encoderStatus = encoderStatus;
exports.decoderStatus = decoderStatus;
exports.codecStatus = codecStatus;
exports.data_encode = data_encode;
exports.data_decode = data_decode;
exports.data = data$1;
exports.json = json;
/* data Not a pure module */
