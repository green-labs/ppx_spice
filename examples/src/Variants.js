// Generated by ReScript, PLEASE EDIT WITH CARE
'use strict';

let Spice = require("@greenlabs/ppx-spice/src/rescript/Spice.js");
let Stdlib_Option = require("@rescript/runtime/lib/js/Stdlib_Option.js");
let Stdlib_Result = require("@rescript/runtime/lib/js/Stdlib_Result.js");

function language_encode(v) {
  switch (v) {
    case "ReScript" :
      return "ReScript";
    case "OCaml" :
      return "OCaml";
    case "TypeScript" :
      return "TypeScript";
    case "JavaScript" :
      return "JavaScript";
  }
}

function language_decode(v) {
  switch (typeof v) {
    case "string" :
      if ("ReScript" === v) {
        return {
          TAG: "Ok",
          _0: "ReScript"
        };
      } else if ("OCaml" === v) {
        return {
          TAG: "Ok",
          _0: "OCaml"
        };
      } else if ("TypeScript" === v) {
        return {
          TAG: "Ok",
          _0: "TypeScript"
        };
      } else if ("JavaScript" === v) {
        return {
          TAG: "Ok",
          _0: "JavaScript"
        };
      } else {
        return Spice.error(undefined, "Not matched", v);
      }
    case "number" :
      return Spice.error(undefined, "Not matched", v);
    default:
      return Spice.error(undefined, "Not a JSONString", v);
  }
}

function user_encode(v) {
  let extra = v.nickname;
  return Object.fromEntries(Spice.filterOptional([
    [
      "id",
      Spice.intToJson(v.id)
    ],
    [
      "nickname",
      Spice.optionToJson(Spice.stringToJson, extra)
    ],
    [
      "language",
      language_encode(v.language)
    ]
  ]));
}

function user_decode(v) {
  if (typeof v !== "object" || v === null || Array.isArray(v)) {
    return Spice.error(undefined, "Not an object", v);
  }
  let id_result = Stdlib_Option.getOr(Stdlib_Option.map(v["id"], Spice.intFromJson), Spice.error(undefined, "id" + " missing", v));
  let nickname_result = Stdlib_Option.getOr(Stdlib_Option.map(v["nickname"], extra => Spice.optionFromJson(Spice.stringFromJson, extra)), {
    TAG: "Ok",
    _0: undefined
  });
  let language_result = Stdlib_Option.getOr(Stdlib_Option.map(v["language"], language_decode), Spice.error(undefined, "language" + " missing", v));
  if (id_result.TAG === "Ok") {
    if (nickname_result.TAG === "Ok") {
      if (language_result.TAG === "Ok") {
        return {
          TAG: "Ok",
          _0: {
            id: id_result._0,
            nickname: nickname_result._0,
            language: language_result._0
          }
        };
      }
      let e = language_result._0;
      return Spice.error("language", e.message, e.value);
    }
    let e$1 = nickname_result._0;
    return Spice.error("nickname", e$1.message, e$1.value);
  }
  let e$2 = id_result._0;
  return Spice.error("id", e$2.message, e$2.value);
}

let data = {
    "id": 1,
    "nickname": "bob",
    "language": "ReScript"
  };

let user = user_decode(data);

let json = user_encode(Stdlib_Result.getOrThrow(user, undefined));

let language = language_decode("ReScript");

exports.language_encode = language_encode;
exports.language_decode = language_decode;
exports.user_encode = user_encode;
exports.user_decode = user_decode;
exports.data = data;
exports.user = user;
exports.json = json;
exports.language = language;
/* user Not a pure module */
