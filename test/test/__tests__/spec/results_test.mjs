// Generated by ReScript, PLEASE EDIT WITH CARE

import * as Zora from "zora";
import * as Results from "../../../src/Results.mjs";

function testEqual(t, name, lhs, rhs) {
  t.test(name, async t => {
    t.equal(lhs, rhs, name);
  });
}

Zora.test("result<int, string> - Ok case", t => {
  let sample = [
    "Ok",
    42.0
  ];
  let sampleRecord = {
    TAG: "Ok",
    _0: 42
  };
  let encoded = Results.simpleResult_encode(sampleRecord);
  testEqual(t, `encode Ok`, encoded, sample);
  let decoded = Results.simpleResult_decode(sample);
  testEqual(t, `decode Ok`, decoded, {
    TAG: "Ok",
    _0: sampleRecord
  });
});

Zora.test("result<int, string> - Error case", t => {
  let sample = [
    "Error",
    "something went wrong"
  ];
  let sampleRecord = {
    TAG: "Error",
    _0: "something went wrong"
  };
  let encoded = Results.simpleResult_encode(sampleRecord);
  testEqual(t, `encode Error`, encoded, sample);
  let decoded = Results.simpleResult_decode(sample);
  testEqual(t, `decode Error`, decoded, {
    TAG: "Ok",
    _0: sampleRecord
  });
});

Zora.test("result<inner, string> - Ok with record", t => {
  let sample = [
    "Ok",
    {
      name: "test",
      value: 123.0
    }
  ];
  let sampleRecord = {
    TAG: "Ok",
    _0: {
      name: "test",
      value: 123
    }
  };
  let encoded = Results.recordResult_encode(sampleRecord);
  testEqual(t, `encode Ok with record`, encoded, sample);
  let decoded = Results.recordResult_decode(sample);
  testEqual(t, `decode Ok with record`, decoded, {
    TAG: "Ok",
    _0: sampleRecord
  });
});

Zora.test("result<inner, string> - Error case", t => {
  let sample = [
    "Error",
    "validation failed"
  ];
  let sampleRecord = {
    TAG: "Error",
    _0: "validation failed"
  };
  let encoded = Results.recordResult_encode(sampleRecord);
  testEqual(t, `encode Error`, encoded, sample);
  let decoded = Results.recordResult_decode(sample);
  testEqual(t, `decode Error`, decoded, {
    TAG: "Ok",
    _0: sampleRecord
  });
});

Zora.test("result<result<int, string>, string> - nested Ok", t => {
  let sample = [
    "Ok",
    [
      "Ok",
      99.0
    ]
  ];
  let sampleRecord = {
    TAG: "Ok",
    _0: {
      TAG: "Ok",
      _0: 99
    }
  };
  let encoded = Results.nestedResult_encode(sampleRecord);
  testEqual(t, `encode nested Ok(Ok(...))`, encoded, sample);
  let decoded = Results.nestedResult_decode(sample);
  testEqual(t, `decode nested Ok(Ok(...))`, decoded, {
    TAG: "Ok",
    _0: sampleRecord
  });
});

Zora.test("result<result<int, string>, string> - nested Error", t => {
  let sample = [
    "Ok",
    [
      "Error",
      "inner error"
    ]
  ];
  let sampleRecord = {
    TAG: "Ok",
    _0: {
      TAG: "Error",
      _0: "inner error"
    }
  };
  let encoded = Results.nestedResult_encode(sampleRecord);
  testEqual(t, `encode nested Ok(Error(...))`, encoded, sample);
  let decoded = Results.nestedResult_decode(sample);
  testEqual(t, `decode nested Ok(Error(...))`, decoded, {
    TAG: "Ok",
    _0: sampleRecord
  });
});

Zora.test("result<result<int, string>, string> - outer Error", t => {
  let sample = [
    "Error",
    "outer error"
  ];
  let sampleRecord = {
    TAG: "Error",
    _0: "outer error"
  };
  let encoded = Results.nestedResult_encode(sampleRecord);
  testEqual(t, `encode outer Error`, encoded, sample);
  let decoded = Results.nestedResult_decode(sample);
  testEqual(t, `decode outer Error`, decoded, {
    TAG: "Ok",
    _0: sampleRecord
  });
});

export {
  testEqual,
}
/*  Not a pure module */
